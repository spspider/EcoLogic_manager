<!DOCTYPE html>
<html lang="en">

<head>
    <title>Other setup</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="scripts/style_generated.css">
    <script defer type="text/javascript" src="scripts/helper_func.js"></script>
    <script type="text/javascript" src="scripts/other_setup.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="public" />
</head>

<body>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            loadBootstrap();
        });
    </script>
    <div class="container">
        <div class="row" style="text-align:center;">
            <div class="col-sm-offset-2 ">
                <form id="form" class="form-signin" method='POST' action='#'>
                    <h4>IoT client setup</h4>
                    <div class="row">
                        <div class="col-sm-6">
                            <!--  DO NOT ALTER THIS COMMENTS 
                            Use IoT
                            <input type='checkbox' class="form-control" name='iot_enable' id="iot_enable"
                                value="Use IoT" />
                            Server
                            <input type='text' value="{{mqttServerName}}" class="form-control"
                                                                                                                                                placeholder='server (m20.cloudmqtt.com)' name='mqttServerName' />
                                                                                                                                            User
                            <input type='text' value="{{mqttuser}}" class="form-control" placeholder='client (name)'
                                name='mqttuser' />
                            Send interval
                            <input type='text' value="{{mqttspacing}}" class="form-control" placeholder='60 (sec)'
                                name='mqttspacing' />
                            Port
                            <input type='text' value="{{mqttport}}" class="form-control" placeholder='port (6231)'
                                name='mqttport' />
                            Password
                            <input type='text' value="{{mqttpass}}" class="form-control" placeholder='password (pass)'
                                name='mqttpass' /> -->
                            Server Device ID:
                            <input type='text' value="{{deviceID}}" class="form-control" placeholder='auto-generated' name='deviceID' readonly style='background-color: #f5f5f5;' />
                            
                            <!-- New Server URL Field -->
                            Server URL:
                            <input type='text' value='{{server_url}}' class="form-control" placeholder='ecologic.pp.ua' name='server_url'
                                id="server_url" maxlength="32" />
                            
                            User Name:
                            <input type='text' value='{{user_name}}' class="form-control" placeholder='admin' name='user_name'
                                id="user_name" maxlength="16" pattern="[a-zA-Z0-9_]+" title="Only letters, numbers and underscore allowed" />
                            
                            <!-- New Test Connection Button 
                            <button type="button" class="btn btn-info" style="margin-top:10px;" onclick="testMQTTConnection()">Test
                                Connection</button>
                            <span id="mqtt_test_result" style="margin-left:10px;"></span>
                            -->
                        </div>

                        <div class="col-sm-6">
                            <p>Email:</p>
                            </br>
                            Provider address
                            <input type='text' class="form-control" placeholder='(mail.smtp2go.com)'
                                value='{{smtp_arr}}' name='smtp_arr' />
                            Port
                            <input type='text' class="form-control" placeholder='2525' value='{{smtp_port}}'
                                name='smtp_port' />
                            Recipient Email
                            <input type='text' class="form-control" placeholder='spspider@mail.ru'
                                value='{{to_email_addr}}' name='to_email_addr' />
                            Sender Email
                            <input type='text' class="form-control" placeholder='from_email_addr'
                                value='{{from_email_addr}}' name='from_email_addr' />
                            Sender Email login
                            <input type='text' class="form-control" placeholder='login' value='{{emaillogin}}'
                                name='emaillogin' />
                            Sender Email password
                            <input type='text' class="form-control" placeholder='password' value='{{password_email}}'
                                name='password_email' />
                            <br />
                        </div>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-6">
                            Device port:
                            <input type='text' class="form-control" placeholder='ipport' value='{{ipport}}'
                                name='ipport' />
                            GMT+ (timezone):
                            <input type='text' id="timezone" class="form-control" placeholder='0' value='{{timezone}}' name='timezone' />
                            <br>
                            Use Static IP:
                            <input type='checkbox' class="form-control" name='use_static_ip' id="use_static_ip" onchange="toggleStaticIP()" />
                            <div id="static_ip_fields" style="display:none;">
                                Static IP:
                                <input type='text' class="form-control" placeholder='192.168.1.100' value='{{static_ip}}'
                                    name='static_ip' id='static_ip' pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" />
                                Gateway:
                                <input type='text' class="form-control" placeholder='192.168.1.1' value='{{gateway}}'
                                    name='gateway' id='gateway' pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" />
                                Subnet:
                                <input type='text' class="form-control" placeholder='255.255.255.0' value='{{subnet}}'
                                    name='subnet' id='subnet' pattern="^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$" />
                            </div>
                        </div>
                        <div class="col-sm-6">
                            <div>
                                PWM frequency:<p id="PWMfreq"></p>
                                <input type='range' class="form-control" name='PWM_frequency' id="PWM_frequency"
                                    value="" onchange="FreqChange()" min="100" max="40000" />
                            </div>
                        </div>
                        <br>
                    </div>
                    <hr>
                    <div class="row">
                        <div class="col-sm-6">
                            <h4>Telegram setup</h4>
                            <div>
                                Telegram BOTtoken:<p id="BOTtoken_"></p>
                                <input type='text' class="form-control" name='BOTtoken' id="BOTtoken" value="{{BOTtoken}}" />
                            </div>
                            <br>
                        </div>
                        <div class="col-sm-6">
                            <strong>Node-RED Server</strong>
                            <div>
                                Use node-red
                                <input type='checkbox' class="form-control" name='send_to_nodeRed' id="send_to_nodeRed" value="0" />
                                <p>Node-RED Server Address:</p>
                                <input type='text' class="form-control" name='nodered_address' id="nodered_address"
                                    placeholder='http://192.168.1.100:1880' value="{{nodered_address}}" maxlength="32"/>
                            </div>
                        </div>
                    </div>
                    <input type='button' class="btn btn-lg btn-primary btn-block" value='Save' onclick="CatchForm();" />
                </form>

                <div id="test"></div>
                <br />
                <br />
                <pre id="input"></pre>
                <pre id="output"></pre>
                <p id="btmBtns"></p>
            </div>
        </div>
    </div>
</body>

</html>
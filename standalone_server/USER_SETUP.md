# Настройка пользовательской системы

## Быстрая настройка

1. **Обновите базу данных:**
   ```bash
   python setup_users.py
   ```

2. **Перезапустите сервер:**
   ```bash
   python app_fastapi.py
   ```

## Что изменилось

- Каждый пользователь видит только свои устройства
- Админ (`admin/admin123`) видит все устройства
- Добавлена страница регистрации: `/api/register`
- Устройства привязываются к пользователям

## Регистрация устройств

При настройке Arduino добавьте параметр `user` в URL:
```
POST /api/cfg?id=my_device&tk=token123&ip=192.168.1.100&user=username
```

Если параметр `user` не указан, устройство назначается админу.

## Структура базы данных

### Таблица `users`
- `username` - имя пользователя (уникальное)
- `password` - пароль (в открытом виде)

### Таблица `devices` (добавлено поле)
- `owner` - владелец устройства

## Безопасность

⚠️ **Внимание:** Пароли хранятся в открытом виде. Для продакшена рекомендуется добавить хеширование.